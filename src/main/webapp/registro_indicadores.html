<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<meta name="robots" content="noindex,follow">
	<title>Registro - Region Ica - Indicadores</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<link rel="stylesheet" type="text/css" href="css\default.css">
	<link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.min.css" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="css\common_config.css">
	<link rel="stylesheet" type="text/css" href="css\status_config.css">
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/css/bootstrap-datetimepicker.min.css" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="css\ace.min.css">
	<link rel="stylesheet" type="text/css" href="css\ace-mantis.css">
	<link rel="stylesheet" type="text/css" href="css\ace-skins.min.css">
	<link rel="shortcut icon" href="images\favicon.ico" type="image/x-icon">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.2.1/themes/default/style.min.css" />
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js" integrity="sha256-xNjb53/rY+WmG+4L6tTl9m6PpqknWZvRt0rO1SRnJzw=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.2.1/jstree.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
	<style>
    canvas {
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
    }
    </style>
</head>
<body class="skin-3">
	<!-- Inicio Barra Navegacion  -->
	<div id="navbar" class="navbar navbar-default navbar-collapse navbar-fixed-top noprint">
		<div id="navbar-container" class="navbar-container">
			<button id="menu-toggler" type="button" class="navbar-toggle menu-toggler pull-left hidden-lg" data-target="#sidebar">
				<span class="sr-only">Toggle sidebar</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
			</button>
			<div class="navbar-header">
				<a href="#" class="navbar-brand"><span class="smaller-75"> Sistema de Gesti&oacute;n de Indicadores </span></a>
				<button type="button" class="navbar-toggle navbar-toggle-img collapsed pull-right hidden-sm hidden-md hidden-lg" data-toggle="collapse" data-target=".navbar-buttons,.navbar-menu">
					<span class="sr-only">Toggle user menu</span><img class="nav-user-photo" src="https://secure.gravatar.com/avatar/6961e2f6353cdc06d6f2b33a67d8ff72?d=identicon&amp;r=G&amp;s=32" alt="Administrador">
				</button>
			</div>
			<div class="navbar-buttons navbar-header navbar-collapse collapse">
				<ul class="nav ace-nav">
					<li class="grey">
						<a data-toggle="dropdown" href="#" class="dropdown-toggle">
							<img class="nav-user-photo" src="https://secure.gravatar.com/avatar/6961e2f6353cdc06d6f2b33a67d8ff72?d=identicon&amp;r=G&amp;s=32" alt="administrador">
							<span class="user-info">administrador</span>
							<i class="ace-icon fa fa-angle-down"></i>
						</a>
						<ul class="user-menu dropdown-menu dropdown-menu-right dropdown-yellow dropdown-caret dropdown-close">
						<!--
							<li><a href="./crear_cuenta.html"><i class="ace-icon fa fa-user"> </i> Mi cuenta</a></li>
							<li class="divider"></li>
						-->
							<li><a href="./index.html"><i class="ace-icon fa fa-sign-out"> </i> Salir</a></li>
						</ul>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<!-- Fin Barra Navegacion  -->
	
	<!-- Inicio Menu  -->
	<div class="main-container" id="main-container">
		<div id="sidebar" class="sidebar sidebar-fixed responsive compact ">
			<ul class="nav nav-list">
				<li>
					<a href="./my_view_page.html">
						<i class="menu-icon fa fa-cubes"></i>
						<span class="menu-text"> Vista General </span>
					</a>
					<b class="arrow"></b>
				</li>
				<li class="active">
					<a href="./registro_indicadores.html">
						<i class="menu-icon fa fa-tachometer"></i>
						<span class="menu-text"> Registro Indicadores </span>
					</a>
					<b class="arrow"></b>
				</li>
			</ul>
			<div id="sidebar" class="sidebar-toggle sidebar-collapse">
				<i data-icon2="ace-icon fa fa-angle-double-right" data-icon1="ace-icon fa fa-angle-double-left" class="ace-icon fa fa-angle-double-left"></i>
			</div>
		</div>
		<!-- Fin Menu  -->
		<!-- Inicio Contenido -->
		<div class="main-content">
			<!-- Inicio Barra Busqueda -->
			<div id="breadcrumbs" class="breadcrumbs noprint">
				<ul class="breadcrumb">
				  <li>
					  <i class="fa fa-user home-icon active"></i>
					  <a href="#">Administrador ( Telly Tataje ) </a>
					  <span class="label hidden-xs label-default arrowed">administrador</span>
				  </li>
				</ul>
			</div>
			<!-- Fin Barra Busqueda -->
			<!-- Inicio Contenido -->
			<div class="page-content">
				<div class="row">
					<div class="col-md-12 col-xs-12">
						<form id="report_bug_form" method="post" action="#" class="dropzone-form">
							<input type="hidden" name="m_id" value="0">
							<input type="hidden" name="project_id" value="1">
							<div class="widget-box widget-color-blue2">
								<div class="widget-header widget-header-small">
									<h4 class="widget-title lighter">
										<i class="ace-icon fa fa-edit"></i>
										Configuraci&oacute;n de Indicadores
									</h4>
								</div>
								<div class="widget-body dz-clickable">
									<div class="widget-main no-padding">
										<div class="table-responsive">
											<div id="jstree"></div>
											<!-- Inicio Modal -->
											<div id="modalDIV" class="modal fade">
											  <div class="modal-dialog" role="document">
											    <div class="modal-content">
											      <div class="modal-header">
											      	<table>
											      	<tr>
											      	<td>
											      	<img src="images/regionica_pie.png" height="45" alt="Region Ica">
											      	</td>
											      	<td>
											      	<h4 id="title-modal" class="modal-title">titulo</h4>
											      	</td>
											      	<td>
													<button type="button" class="close" data-dismiss="modal" aria-label="Close">
											          <span aria-hidden="true">&times;</span>
											        </button>
											      	</td>
											      	</tr>
											      	</table>
											      </div>
											      <div class="modal-body">
											        <canvas id="chartCanvas"></canvas>
											      </div>
											      <div class="modal-footer">
											        <button type="button" class="btn btn-primary odom-modificar">Modificar</button>
											        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
											      </div>
											    </div>
											  </div>
											</div>
											<!-- Fin Modal -->
											<!-- Inicio Modal -->
											<div id="modalRegistroDIV" class="modal fade">
											  <div class="modal-dialog" role="document">
											    <div class="modal-content">
											      <div class="modal-header">
											      	<table>
											      	<tr>
											      	<td>
											      	<img src="images/regionica_pie.png" height="45" alt="Region Ica">
											      	</td>
											      	<td>
											      	<h4 id="title-registro" class="modal-title">titulo</h4>
											      	</td>
											      	<td>
													<button type="button" class="close" data-dismiss="modal" aria-label="Close">
											          <span aria-hidden="true">&times;</span>
											        </button>
											      	</td>
											      	</tr>
											      	</table>
											      </div>
											      <div class="modal-body">
											        <table>
											        <tr>
											        <td>Descripci&oacute;n</td>
											        <td><input type="text" name="descripcion" id="descripcion" /></td>
											        </tr>
											        <tr id="tr-tipo">
											        <td>Tipo Gr&aacute;fico</td>
											        <td>
											        <select id="tipo" name="tipo">
											        <option value="bar">Barras</option>
											        <option value="stackedBar">Stacked Barras</option>
											        <option value="pie">Pie</option>
											        </select>
											        </td>
											        </tr>
											        </table>
											      </div>
											      <div class="modal-footer">
											        <button type="button" class="btn btn-primary odom-guardar">Guardar</button>
											        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
											      </div>
											    </div>
											  </div>
											</div>
											<!-- Fin Modal -->
										</div>
									</div>
									<div class="widget-toolbox padding-8 clearfix">
										<input tabindex="12" type="button" class="btn btn-primary btn-white btn-round odom-imprimir" value="Imprimir">
									</div>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
			<!-- Fin Contenido -->
		</div>
		<div class="clearfix"></div>
		<div class="space-20"></div>
		<div class="footer noprint">
			<div class="footer-inner">
				<div class="footer-content">
					<div class="col-md-6 col-xs-12 no-padding">
					</div>
					<div class="col-md-6 col-xs-12">
						<div class="pull-right">
							<img src="images\regionica_pie.png" height="35" alt="Region Ica">
						</div>
					</div>
				</div>
			</div>
		</div>
		<a class="btn-scroll-up btn btn-sm btn-inverse display" id="btn-scroll-up" href="#">
			<i class="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>
		</a>
	</div>
	<script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha256-KXn5puMvxCw+dAYznun+drMdG1IFl3agK0p/pqT9KAo=" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.15.2/moment-with-locales.min.js" integrity="sha256-K+AZsAFjiBd4piqBmFzaxDsiQiHfREubm1ExNGW1JIA=" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/js/bootstrap-datetimepicker.min.js" integrity="sha256-I8vGZkA2jL0PptxyJBvewDVqNXcgIhcgeqi+GD/aw34=" crossorigin="anonymous"></script>
	<script type="text/javascript" src="js\ace-extra.min.js"></script>
	<script type="text/javascript" src="js\ace-elements.min.js"></script>
	<script type="text/javascript" src="js\ace.min.js"></script>
	<script type="text/javascript">
	var nodeSelected = null;
	window.chartColors = {
		red: 'rgb(255, 99, 132)',
		orange: 'rgb(255, 159, 64)',
		yellow: 'rgb(255, 205, 86)',
		green: 'rgb(75, 192, 192)',
		blue: 'rgb(54, 162, 235)',
		purple: 'rgb(153, 102, 255)',
		grey: 'rgb(201, 203, 207)'
	};
	
	window.randomScalingFactor = function() {
		var num1 = 1000;
		var num2 = 9999999;
		return Math.floor(Math.random() * (num2-num1 + 1) + num1);
	};
		
	var arrayCollection = [{
		"text" : "Region Ica",
		"state" : { "opened" : true },
		"children" : [
						{"id": 1, "text": "2017", "state" : { "opened" : true }, "type" : "folder", "children": 
						[
							{"id": 2, "parent" : 1, "text": "Marzo", "state" : { "opened" : true }, "type" : "folder", "children": 
							[
								{"id": 3, "parent" : 2, "text": "Exportacion", "state" : { "opened" : true }, "type" : "folder", "children": 
								[
									{"id": 4, "parent" : 3, "text": "Por Sectores", "state" : { "opened" : true }, "type" : "folder", "children": 
									[
										{"id": 5, "parent" : 4, "text": "EXPORTACIONES POR SECTORES ECONÓMICOS 2000-2016 (Millones US$ FOB)","icon" : "glyphicon glyphicon-dashboard", "type" : "chart"},
										{"id": 6, "parent" : 4, "text": "EXPORTACIONES DE LOS SECTORES POR PRODUCTO 2015 (Millones US$ FOB)","icon" : "glyphicon glyphicon-dashboard", "type" : "chart"},
										{"id": 7, "parent" : 4, "text": "Sector Agrícola", "state" : { "opened" : true }, "type" : "folder", "children": 
										[
											{"id": 8, "parent" : 7, "text": "EXPORTACIONES AGROPECUARIAS POR PRODUCTO 2015 (Millones US$ FOB)","icon" : "glyphicon glyphicon-dashboard", "type" : "chart"},
											{"id": 9, "parent" : 7, "text": "EXPORTACIONES AGROPECUARIAS POR PRODUCTO 2000-2016 (Millones US$ FOB)","icon" : "glyphicon glyphicon-dashboard", "type" : "chart"},
											{"id": 10, "parent" : 7, "text": "Uvas Frescas", "state" : { "opened" : true }, "type" : "folder", "children": 
											[
												{"id": 11, "parent" : 10, "text": "VOLUMEN EXPORTADO (t) Y PRECIO FOB (US$ / kg) DE LA UVA Campañas 00/01-15/16","icon" : "glyphicon glyphicon-dashboard", "type" : "chart"},
												{"id": 12, "parent" : 10, "text": "PRECIOS (US$ / kg) Y VOLÚMENES (t) MENSUALESDE LA DE LA EXPORTACIÓN DE UVA Campañas 14/15-16/17","icon" : "glyphicon glyphicon-dashboard", "type" : "chart"},
												{"id": 13, "parent" : 10, "text": "EXPORTACIONES DE UVA POR PAÍS DE DESTINO Campañas 00/01-15/16 (t)","icon" : "glyphicon glyphicon-dashboard", "type" : "chart"},
												{"id": 14, "parent" : 10, "text": "EXPORTACIONES DE UVA POR EMPRESA EXPORTADORA Campañas 00/01-15/16 (t)","icon" : "glyphicon glyphicon-dashboard", "type" : "chart"},
											]},
											{"id": 15, "parent" : 7, "text": "Espárragos Frescos", "state" : { "opened" : true }, "type" : "folder", "children": [
												{"id": 16, "parent" : 15, "text": "VOLUMEN EXPORTADO (t) Y PRECIO FOB (US$ / kg) DEL ESPÁRRAGO FRESCO 2000-2016","icon" : "glyphicon glyphicon-dashboard", "type" : "chart"},
												{"id": 17, "parent" : 15, "text": "PRECIOS (US$ / kg) Y VOLÚMENES (t) MENSUALES DE LA EXPORTACIÓN DE ESPÁRRAGO FRESCO 2014-2016","icon" : "glyphicon glyphicon-dashboard", "type" : "chart"},
												{"id": 18, "parent" : 15, "text": "EXPORTACIONES DE ESPÁRRAGO FRESCO POR PAÍS DE DESTINO 2010-2016 (t)","icon" : "glyphicon glyphicon-dashboard", "type" : "chart"},
												{"id": 19, "parent" : 15, "text": "EXPORTACIONES DE ESPÁRRAGO FRESCO POR EMPRESA EXPORTADORA 2010-2016 (t)","icon" : "glyphicon glyphicon-dashboard", "type" : "chart"}
											]},
										]},
									]},
								]},
							]},
						] },
					]
		}];
	
	
	var barChartData = {
	        labels: ["2010", "2011", "2012", "2013", "2014", "2015", "2016"],
	        datasets: [{
	            label: 'CFG INVESTMENT',
	            backgroundColor: window.chartColors.red,
	            data: [
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor()
	            ]
	        }, {
	            label: 'PESQUERA DIAMANTE',
	            backgroundColor: window.chartColors.blue,
	            data: [
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor()
	            ]
	        }, {
	            label: 'AUSTRAL GROUP',
	            backgroundColor: window.chartColors.green,
	            data: [
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor()
	            ]
	        }, {
	            label: 'PESQUERA EXALMAR',
	            backgroundColor: window.chartColors.yellow,
	            data: [
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor()
	            ]
	        }, {
	            label: 'PESQUERA HAYDUK',
	            backgroundColor: window.chartColors.purple,
	            data: [
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor()
	            ]
	        }, {
	            label: 'PESQUERA CENTINELA',
	            backgroundColor: window.chartColors.grey,
	            data: [
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor()
	            ]
	        }, {
	            label: 'COPEINCA',
	            backgroundColor: window.chartColors.orange,
	            data: [
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor(),
	                randomScalingFactor()
	            ]
	        }]
	
	    };
	$(function () {
		var title = "";

		$("#modalDIV").modal("hide");
		
		$("#modalRegistroDIV").modal("hide");
		
		$('body').on('click','.odom-modificar',function(e){
			var link = document.createElement('a');
			link.href = './chart_editor.html?title=' + title;
			document.body.appendChild(link);
			link.click(); 
		});
		
		$('body').on('click','.odom-guardar',function(e){
			var ref = $('#jstree').jstree(true),
				sel = ref.get_selected();
			//FIXME falta cambiar
			var dd = $("#descripcion");
			if(!sel.length) { return false; }
			sel = sel[0];
			sel = ref.create_node(sel, {"type":"file"});
			if(sel) {
				ref.edit(sel);
			}			
		});
		
		$('body').on('click','.odom-imprimir',function(e){
			alert('Imprimir!');
		});
		
		var ctx = document.getElementById('chartCanvas').getContext('2d');
		
	    window.myBar = new Chart(ctx, {
	        type: 'bar',
	        data: barChartData,
	        options: {
	            title:{
	                display: false,
	                text:""
	            },
	            tooltips: {
	                mode: 'index',
	                intersect: false
	            },
	            responsive: true,
	            scales: {
	                xAxes: [{
	                    stacked: true,
	                }],
	                yAxes: [{
	                    stacked: true
	                }]
	            }
	        }
	    });
	
		function crear() {
			var ref = $('#jstree').jstree(true),
				sel = ref.get_selected();
			if(!sel.length) { return false; }
			sel = sel[0];
			sel = ref.create_node(sel, {"type":"file"});
			if(sel) {
				ref.edit(sel);
			}
		};
		function modificar() {
			var ref = $('#jstree').jstree(true),
				sel = ref.get_selected();
			if(!sel.length) { return false; }
			sel = sel[0];
			ref.edit(sel);
		};
		function eliminar() {
			var ref = $('#jstree').jstree(true),
				sel = ref.get_selected();
			if(!sel.length) { return false; }
			ref.delete_node(sel);
		};
	
	
		$('#jstree').jstree({"plugins" : [ "contextmenu", "types", "search", "state", "wholerow" ],
		'core' : {
			'data' : arrayCollection
		},
		"check_callback" : true,
		'unique' : {
			'duplicate' : function (name, counter) {
				return name + ' ' + counter;
			}
		},	
		"contextmenu": {
			"items": function (node) {
				var tree = $('#jstree').jstree(true);
				var menu = {
					"Create": {
						"label": "Nuevo",
						"submenu" : {
							"Section": {
								"separator_after"	: true,
								"label": "Seccion",
								"action": function (obj) { 
									nodeSelected = _node;
									$('#title-registro').text("Agregar Seccion");
									$('#tr-tipo').hide();
									$("#modalRegistroDIV").modal("show");
								}
							},
							"Chart": {
								"label": "Grafico",
								"action": function (obj) { 
									nodeSelected = _node;
									$('#title-registro').text("Agregar Gráfico");
									$('#tr-tipo').show();
									$("#modalRegistroDIV").modal("show"); 
								}
							}
						}
					},
					"Rename": {
						"label": "Renombrar",
						"action": function (data) { 
							nodeSelected = _node;
							modificar();
						}
					},
					"Delete": {
						"label": "Eliminar",
						"action": function (obj) { 
							nodeSelected = _node;
							eliminar();
						}
					},
					"Edit":{
						"label": "Modificar",
						"submenu" : {
							"Copy": {
								"separator_after"	: true,
								"label": "Copiar",
								"action": function (obj) { this.copy(obj); }
							},
							"Cut": {
								"separator_after"	: true,
								"label": "Cortar",
								"action": function (obj) { this.cut(obj); }
							},
							"Paste": {
								"label": "Pegar",
								"action": function (obj) { this.paste(obj); },
								"_disabled" : true
							}
						}
					}
				};
				
				if(node.children.length > 0){
					delete menu.Delete;
				}
	
				if(node.icon === "glyphicon glyphicon-dashboard") {
					delete menu.Create;
				}
				
				if(node.parent == "#"){
					return null;
				}
				
				return menu;
			}
		}
		});
		
		$('#jstree').bind("dblclick.jstree",function (e) {
			var li = $(e.target).closest("li");
			var item = li[0].id;
			var node = $('#jstree').jstree(true).get_node(item);
	
			if(node.icon === "glyphicon glyphicon-dashboard") {
				title = node.text;
				$('#title-modal').text(node.text);
				$("#modalDIV").modal("show");
				//alert("Grafico : [" + node.id + "] " + node.text + " / Padre : " + node.parent);
	            barChartData.datasets.forEach(function(dataset, i) {
	                dataset.data = dataset.data.map(function() {
	                    return randomScalingFactor();
	                });
	            });
	            window.myBar.update();
			}
		});
		
	});
	</script>
</body>
</html>
